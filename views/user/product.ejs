<!DOCTYPE html>
<html>
   <head>
      <!-- Basic -->
      <meta charset="utf-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <!-- Mobile Metas -->
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
      <!-- Site Metas -->
      <meta name="keywords" content="" />
      <meta name="description" content="" />
      <meta name="author" content="" />
      <link rel="shortcut icon" href="/user/images/favicon.png" type="">
      <title>Famms - Fashion HTML Template</title>
      <!-- bootstrap core css -->
      <link rel="stylesheet" type="text/css" href="/user/css/bootstrap.css" />
      <!-- font awesome style -->
      <link href="/user/css/font-awesome.min.css" rel="stylesheet" />
      <!-- Custom styles for this template -->
      <link href="/user/css/style.css" rel="stylesheet" />
      <!-- responsive style -->
      <link href="/user/css/responsive.css" rel="stylesheet" />
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
   </head>
   <body class="sub_page">
      <div class="hero_area">
         <!-- header section strats -->
         <%-include('./partials/navbar.ejs')%>
         <!-- end header section -->
      </div>
      
      <!-- product section -->
      <section class="product_section layout_padding">
         <div class="container">
           <div class="heading_container heading_center">
           
               <h2>
                   Our <span>products</span>
               </h2>
               <form class="form-inline" id="searchForm">
                <div class="input-group">
                    <input class="form-control" type="search" id="searchInput" placeholder="Search" aria-label="Search">
                    <div class="input-group-append">
                        <button class="btn" type="submit" style="background-color: #BAFF39;">
                            <i class="fa fa-search" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            </form>
            
               <script>
                 
                 
    // Get the form element
    const searchForm = document.getElementById('searchForm');

    // Add event listener for form submission
    searchForm.addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent the default form submission behavior

        // Get the search query from the input field
        const searchQuery = document.getElementById('searchInput').value.trim();

        // Construct the URL for the search request
        const searchUrl = `/userSideProduct/:?query=${encodeURIComponent(searchQuery)}`;


        // Redirect the user to the search URL
        window.location.href = searchUrl;
    });

            </script>
            

               <!-- <script>
                                    // Capture form submission event
                                    document.querySelector('.form-inline').addEventListener('submit', async (e) => {
    e.preventDefault(); // Prevent default form submission
    
    const searchQuery = document.querySelector('.form-control').value; // Extract search query
    
    try {
        // Send POST request to server with search query
        const response = await fetch('/productSearch', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ query: searchQuery }) // Send search query as JSON
        });

        if (response.ok) {
         const { value } = await response.json();
         renderProducts(value);
            // Parse response JSON
            
        } else {
            console.error('Search request failed.');
        }
    } catch (error) {
        console.error('Error during search request:', error);
    }
});
function renderProducts(products) {
    // Find the container element
    const productsContainer = document.querySelector('.products-container');

    // Check if the container element exists
    if (productsContainer) {
        // Clear existing products from the container
        productsContainer.innerHTML = '';

        // Loop through the array of products and create HTML elements to display each product
        products.forEach(item => {
            // Create HTML structure for displaying product details
            const productElement = document.createElement('div');
            productElement.classList.add('product-item');

            productElement.innerHTML = `
                <div class="product-image">
                    <img src="${item.image}" alt="${item.name}">
                </div>
                <div class="product-details">
                    <h3>${item.name}</h3>
                    <p>${item.description}</p>
                    <p>Price: $${item.price}</p>
                    <button>Add to Cart</button>
                </div>
            `;

            // Append the product element to the products container
            productsContainer.appendChild(productElement);
        });
    } else {
        console.error('Products container not found');
    }
}

           

               </script> -->
















           
            <div class="input_container">
               
               <button class="btn " type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasScrolling" aria-controls="offcanvasScrolling" id="sort" style="color: black;">Filter</button>
               

               <div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
                 <div class="offcanvas-header">
                   <h5 class="offcanvas-title" id="offcanvasScrollingLabel">Filter</h5>
                   
                   <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                 </div>
                 <div class="offcanvas-body">
                  <style>
                    
                 </style>
                 <br><br>
                 
               <div class="catergorydiv">
                  <label for="sorting-order" class="dropdown-label">Category</label>
                  <div class="dropdown">
                      <button class="dropbtn">Filter</button>
                      <div class="dropdown-content">
                        <% categoryData.forEach((item) => { %>
                            <a style="color:white;" href="/userSideProduct/<%= sortType %>?categoryName=<%= item.Category %>"><%= item.Category %></a>
           <% }) %>
                      </div>
                  </div>
              </div>
                 <br>
               <div class="catergorydiv">
                  <label for="sorting-order" class="dropdown-label">Sorting order</label>
                  <div class="dropdown">
                      <button class="dropbtn">Filter</button>
                      <div class="dropdown-content">
                          <a href="/userSideProduct/aA-zZ">aA-zZ</a>
                          <a href="/userSideProduct/zZ-aA">zZ-aA</a>
                      </div>
                  </div>
              </div>
              <br>
              <div class="catergorydiv">
               <label for="sorting-order" class="dropdown-label">New Arrivals</label>
               <div class="dropdown">
                   <button class="dropbtn">Filter</button>
                   <div class="dropdown-content">
                       <a href="/userSideProduct/new-arrivals">lastest arrivals</a>
                       <a href="/userSideProduct/old-arrivals">old arrivals</a>
                   </div>
               </div>
             </div>
             <br>
            <div class="catergorydiv">
                  <label for="sorting-order" class="dropdown-label">Price</label>
                  <div class="dropdown">
                      <button class="dropbtn">Filter</button>
                      <div class="dropdown-content">
                          <a href="/userSideProduct/Low-High">Low to High</a>
                          <a href="/userSideProduct/High-Low">High to Low</a>
                      </div>
                  </div>
              </div>
              <br>
              <!-- <div class="catergorydiv">
               <label for="sorting-order" class="dropdown-label">Popularity</label>
               <div class="dropdown">
                   <button class="dropbtn">Sort</button>
                   <div class="dropdown-content">
                       <a href="/sortProduct/az-AZ"> Most sreached</a>
                       <a href="/sortProduct/za-ZA">Least sreached</a>
                   </div>
               </div>
              </div>      
              <br>   
              <div class="catergorydiv">
               <label for="sorting-order" class="dropdown-label">Average Ratings</label>
               <div class="dropdown">
                   <button class="dropbtn">Sort</button>
                   <div class="dropdown-content">
                       <a href="/sortProduct/az-AZ">Most rated</a>
                       <a href="/sortProduct/za-ZA">Least rated</a>
                   </div>
               </div>
              </div> 
              <br>
              <div class="catergorydiv">
               <label for="sorting-order" class="dropdown-label"> Featured</label>
               <div class="dropdown">
                   <button class="dropbtn">Sort</button>
                   <div class="dropdown-content">
                       <a href="/sortProduct/az-AZ">Most rated</a>
                       <a href="/sortProduct/za-ZA">Least rated</a>
                   </div>
               </div>
              </div>   -->
                
                 
                
                 
                 </div>
               </div>
           </div>
            
         </div>
            <div class="row products-container">
               <%productDisplay.forEach((items,id)=>{
                  if(!items.isBlocked){%>

               <div class="col-sm-6 col-md-4 col-lg-4">
                  <div class="box">
                     <div class="option_container">
                        <div class="options">
                           
                              <%if(items.stock===0){%>
                                
                                     <button class="option4">Out of stock</button>
                                 
                              <%}else{%>
                                 <form method="post" action="/addcart/<%=items._id%>">
                                     <button class="option1">Add to cart</button>
                                 </form>
                           <%}%>
                          
                           <form method="post" action="/addwishlist/<%=items._id%>">
                           <button class="option3">
                              Add to wishList
                           </button>
                           </form>
                           <a href="/showproductdetails/<%=items._id%>" class="option2">
                           Buy Now
                           </a>
                        </div>
                     </div>
                     <div class="img-box">
                        <img src="<%=items.images[0]%>" alt="">
                     </div>
                     <div class="detail-box">
                        <h5>
                           <%=items.productName%>
                        </h5>
                        <h6>
                           <b>₹ </b><%=items.price%>
                        </h6>
                     </div>
                  </div>
               </div>
               <%}});%>
            </div>
            <div class="btn-box">
               <a href="">
               View All products
               </a>
            </div>
         </div>
      </section>
      <!-- end product section -->
      <!-- footer section -->
      <%-include('./partials/footer.ejs')%>
      <!-- footer end -->
      <div class="cpy_">
         <p class="mx-auto">© 2021 All Rights Reserved By <a href="https://html.design/">Free Html Templates</a><br>
         
            Distributed By <a href="https://themewagon.com/" target="_blank">ThemeWagon</a>
         
         </p>
      </div>
      <!-- footer section -->
      <!-- jQery -->
      <script src="/user/js/jquery-3.4.1.min.js"></script>
      <!-- popper js -->
      <script src="/user/js/popper.min.js"></script>
      <!-- bootstrap js -->
      <script src="js/bootstrap.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
      <!-- custom js -->
      <script src="js/custom.js"></script>
   </body>
</html>